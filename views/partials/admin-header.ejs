<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      <%= typeof title !== 'undefined' ? title : 'Admin - New Generation Pools'
      %>
    </title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <style>
      .sidebar {
        min-height: calc(100vh - 56px);
        background-color: #343a40;
        transition: transform 0.3s ease;
      }
      .sidebar .nav-link {
        color: rgba(255, 255, 255, 0.75);
      }
      .sidebar .nav-link:hover,
      .sidebar .nav-link.active {
        color: #fff;
        background-color: rgba(255, 255, 255, 0.1);
      }
      .sidebar-toggle {
        display: none;
        background: #343a40;
        border: none;
        color: white;
        padding: 0.5rem;
        margin: 0.5rem;
        border-radius: 4px;
        cursor: pointer;
      }
      /* Ensure main content stays in grid */
      .row > main {
        flex: 0 0 auto;
        width: 75%;
      }
      @media (min-width: 992px) {
        .row > main {
          width: 83.33333333%;
        }
      }
      @media (max-width: 991.98px) {
        .sidebar {
          position: fixed;
          left: 0;
          top: 56px;
          z-index: 1000;
          width: 250px;
          transform: translateX(-100%);
          box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }
        .sidebar.show {
          transform: translateX(0);
        }
        .sidebar-toggle {
          display: block;
        }
        main {
          width: 100% !important;
          max-width: 100% !important;
        }
        .sidebar-overlay {
          display: none;
          position: fixed;
          top: 56px;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 999;
        }
        .sidebar-overlay.show {
          display: block;
        }
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-dark bg-dark">
      <div class="container-fluid">
        <button
          class="sidebar-toggle"
          type="button"
          id="sidebarToggle"
          aria-label="Toggle sidebar"
        >
          <i class="bi bi-list"></i>
        </button>
        <span class="navbar-brand mb-0 h1">New Generation Pools - Admin</span>
        <div>
          <a
            href="/"
            target="_blank"
            class="btn btn-outline-light btn-sm me-2"
            title="View Home Page"
          >
            <i class="bi bi-house-door"></i> View Home
          </a>
          <span class="text-white me-3"
            >Welcome, <%= session && session.username ? session.username :
            'Admin' %></span
          >
          <a href="/admin/logout" class="btn btn-outline-light btn-sm"
            >Logout</a
          >
        </div>
      </div>
    </nav>
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="container-fluid">
      <div class="row">
        <nav class="col-md-3 col-lg-2 sidebar p-3" id="adminSidebar">
          <ul class="nav flex-column">
            <li class="nav-item">
              <a class="nav-link" href="/admin">
                <i class="bi bi-speedometer2"></i> Dashboard
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/projects">
                <i class="bi bi-folder"></i> Projects
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/services">
                <i class="bi bi-tools"></i> Services
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/products">
                <i class="bi bi-box"></i> Products
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/customers">
                <i class="bi bi-people"></i> Customers
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/sales">
                <i class="bi bi-receipt"></i> Sales
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/media">
                <i class="bi bi-images"></i> Media Library
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/settings">
                <i class="bi bi-gear"></i> Settings
              </a>
            </li>
          </ul>
        </nav>
        <!-- 
          CRITICAL: Do NOT close the main tag here!
          The view content (dashboard, customers/list, etc.) renders INSIDE this main tag.
          The admin-footer.ejs closes it.
          If you close it here, content will appear below the sidebar instead of beside it.
          
          CORRECT STRUCTURE:
          <div class="row">
            <nav class="col-md-3">sidebar</nav>
            <main class="col-md-9">
              [VIEW CONTENT GOES HERE]
            </main>
          </div>
        -->
        <main class="col-md-9 col-lg-10 p-4">
          <!-- View content renders here -->

<%- include('../../partials/admin-header') %> <% if (typeof success !==
'undefined' && success.length > 0) { %>
<div class="alert alert-success alert-dismissible fade show">
  <%= success[0] %>
  <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
</div>
<% } %> <% if (typeof error !== 'undefined' && error.length > 0) { %>
<div class="alert alert-danger alert-dismissible fade show">
  <%= error[0] %>
  <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
</div>
<% } %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Contact from <%= contactMessage.name %></h1>
  <div>
    <a href="/admin/contacts" class="btn btn-outline-secondary">Back to List</a>
    <form
      method="POST"
      action="/admin/contacts/<%= contactMessage._id %>/delete"
      class="d-inline"
      onsubmit="return confirm('Are you sure you want to delete this contact message?');"
    >
      <button type="submit" class="btn btn-outline-danger">Delete</button>
    </form>
  </div>
</div>

<div class="row">
  <div class="col-md-8">
    <div class="card mb-3">
      <div class="card-header">
        <h5 class="mb-0">Contact Information</h5>
      </div>
      <div class="card-body">
        <div class="row mb-3">
          <div class="col-md-3"><strong>Name:</strong></div>
          <div class="col-md-9"><%= contactMessage.name %></div>
        </div>
        <div class="row mb-3">
          <div class="col-md-3"><strong>Email:</strong></div>
          <div class="col-md-9">
            <a href="mailto:<%= contactMessage.email %>"
              ><%= contactMessage.email %></a
            >
          </div>
        </div>
        <% if (contactMessage.phone) { %>
        <div class="row mb-3">
          <div class="col-md-3"><strong>Phone:</strong></div>
          <div class="col-md-9">
            <a href="tel:<%= contactMessage.phone %>"
              ><%= contactMessage.phone %></a
            >
          </div>
        </div>
        <% } %> <% if (contactMessage.town) { %>
        <div class="row mb-3">
          <div class="col-md-3"><strong>Town:</strong></div>
          <div class="col-md-9"><%= contactMessage.town %></div>
        </div>
        <% } %> <% if (contactMessage.serviceType) { %>
        <div class="row mb-3">
          <div class="col-md-3"><strong>Service Type:</strong></div>
          <div class="col-md-9">
            <span class="badge bg-info"><%= contactMessage.serviceType %></span>
          </div>
        </div>
        <% } %> <% if (contactMessage.message) { %>
        <div class="row mb-3">
          <div class="col-md-3"><strong>Message:</strong></div>
          <div class="col-md-9">
            <div class="border p-3 bg-light rounded">
              <%= contactMessage.message.replace(/\n/g, '<br>') %>
            </div>
          </div>
        </div>
        <% } %>
        <hr />
        <div class="row">
          <div class="col-md-3"><strong>Received:</strong></div>
          <div class="col-md-9">
            <%= new Date(contactMessage.createdAt).toLocaleString() %>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-3"><strong>Status:</strong></div>
          <div class="col-md-9">
            <span
              class="badge bg-<%= contactMessage.isRead ? 'success' : 'warning' %>"
            >
              <%= contactMessage.isRead ? 'Read' : 'Unread' %>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">Quick Actions</h5>
      </div>
      <div class="card-body">
        <a
          href="mailto:<%= contactMessage.email %>?subject=Re: Your Inquiry"
          class="btn btn-primary w-100 mb-2"
        >
          <i class="bi bi-envelope"></i> Reply via Email
        </a>
        <% if (contactMessage.phone) { %>
        <a href="tel:<%= contactMessage.phone %>" class="btn btn-success w-100 mb-2">
          <i class="bi bi-telephone"></i> Call
        </a>
        <% } %>
        <a href="/admin/contacts" class="btn btn-outline-secondary w-100 mb-2">
          <i class="bi bi-arrow-left"></i> Back to All Contacts
        </a>
      </div>
    </div>
  </div>
</div>

<%- include('../../partials/admin-footer') %>

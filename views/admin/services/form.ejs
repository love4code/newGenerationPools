<%- include('../../partials/admin-header') %>

<h1 class="mb-4"><%= service ? 'Edit' : 'Create' %> Service</h1>

<form method="POST" action="<%= service ? `/admin/services/${service._id}` : '/admin/services' %>">
  <div class="row">
    <div class="col-md-8">
      <div class="card mb-3">
        <div class="card-body">
          <div class="mb-3">
            <label for="name" class="form-label">Name *</label>
            <input type="text" class="form-control" id="name" name="name" value="<%= service ? service.name : '' %>" required>
          </div>
          <div class="mb-3">
            <label for="shortDescription" class="form-label">Short Description</label>
            <textarea class="form-control" id="shortDescription" name="shortDescription" rows="2"><%= service ? service.shortDescription : '' %></textarea>
          </div>
          <div class="mb-3">
            <label for="description" class="form-label">Description *</label>
            <textarea class="form-control" id="description" name="description" rows="10" required><%= service ? service.description : '' %></textarea>
          </div>
        </div>
      </div>

      <div class="card mb-3">
        <div class="card-header">SEO Settings</div>
        <div class="card-body">
          <div class="mb-3">
            <label for="seoTitle" class="form-label">SEO Title</label>
            <input type="text" class="form-control" id="seoTitle" name="seoTitle" value="<%= service && service.seoTitle ? service.seoTitle : '' %>">
          </div>
          <div class="mb-3">
            <label for="seoDescription" class="form-label">SEO Description</label>
            <textarea class="form-control" id="seoDescription" name="seoDescription" rows="3"><%= service && service.seoDescription ? service.seoDescription : '' %></textarea>
          </div>
          <div class="mb-3">
            <label for="seoKeywords" class="form-label">SEO Keywords (comma-separated)</label>
            <input type="text" class="form-control" id="seoKeywords" name="seoKeywords" value="<%= service && service.seoKeywords ? service.seoKeywords.join(', ') : '' %>">
          </div>
          <div class="mb-3">
            <label for="seoCanonicalUrl" class="form-label">Canonical URL</label>
            <input type="url" class="form-control" id="seoCanonicalUrl" name="seoCanonicalUrl" value="<%= service && service.seoCanonicalUrl ? service.seoCanonicalUrl : '' %>">
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="seoIndex" name="seoIndex" value="true" <%= !service || service.seoIndex !== false ? 'checked' : '' %>>
            <label class="form-check-label" for="seoIndex">Allow search engines to index</label>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card mb-3">
        <div class="card-header">Settings</div>
        <div class="card-body">
          <div class="mb-3">
            <label for="displayOrder" class="form-label">Display Order</label>
            <input type="number" class="form-control" id="displayOrder" name="displayOrder" value="<%= service ? service.displayOrder : 0 %>">
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="isActive" name="isActive" <%= !service || service.isActive ? 'checked' : '' %>>
            <label class="form-check-label" for="isActive">Active</label>
          </div>
        </div>
      </div>

      <div class="card mb-3">
        <div class="card-header">Icon Image</div>
        <div class="card-body">
          <% if (service && service.iconImage) { %>
            <img src="<%= service.iconImage.thumbnailPath %>" class="img-thumbnail mb-2" alt="Icon">
          <% } %>
          <select class="form-select" id="iconImage" name="iconImage">
            <option value="">None</option>
            <% if (images) { %>
              <% images.forEach(image => { %>
                <option value="<%= image._id %>" <%= service && service.iconImage && service.iconImage._id.toString() === image._id.toString() ? 'selected' : '' %>>
                  <%= image.title || image.filename %>
                </option>
              <% }); %>
            <% } %>
          </select>
        </div>
      </div>

      <div class="card mb-3">
        <div class="card-header">Hero Image</div>
        <div class="card-body">
          <% if (service && service.heroImage) { %>
            <img src="<%= service.heroImage.thumbnailPath %>" class="img-thumbnail mb-2" alt="Hero">
          <% } %>
          <select class="form-select" id="heroImage" name="heroImage">
            <option value="">None</option>
            <% if (images) { %>
              <% images.forEach(image => { %>
                <option value="<%= image._id %>" <%= service && service.heroImage && service.heroImage._id.toString() === image._id.toString() ? 'selected' : '' %>>
                  <%= image.title || image.filename %>
                </option>
              <% }); %>
            <% } %>
          </select>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-3">
    <button type="submit" class="btn btn-primary">Save Service</button>
    <a href="/admin/services" class="btn btn-secondary">Cancel</a>
  </div>
</form>

<%- include('../../partials/admin-footer') %>

